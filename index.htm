<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Arduino Ajax I/O</title>
    <link rel="stylesheet" href="css/estilos.css" />
    <script>
      strLED1 = "";
      strLED2 = "";
      strLED3 = "";
      strLED4 = "";
      var LED3_state = 0;
      var LED4_state = 0;
      function GetArduinoIO() {
        nocache = "&nocache=" + Math.random() * 1000000;
        var request = new XMLHttpRequest();
        request.onreadystatechange = function () {
          if (this.readyState == 4) {
            if (this.status == 200) {
              if (this.responseXML != null) {
                console.log("Respuestas XML");
                console.log(this.responseXML);
                // XML file received - contains analog values, switch values and LED state
                //dht11
                document.getElementById("T1").innerHTML =
                  this.responseXML.getElementsByTagName(
                    "digital2"
                  )[0].childNodes[0].nodeValue;

                document.getElementById("T2").innerHTML =
                  this.responseXML.getElementsByTagName(
                    "digital3"
                  )[0].childNodes[0].nodeValue;

                // get switch inputs
                var num_an =
                  this.responseXML.getElementsByTagName("switch").length;
                for (count = 0; count < num_an; count++) {
                  document.getElementsByClassName("switches")[count].innerHTML =
                    this.responseXML.getElementsByTagName("switch")[
                      count
                    ].childNodes[0].nodeValue;
                }
                // LED 1
                if (
                  this.responseXML.getElementsByTagName("LED")[0].childNodes[0]
                    .nodeValue === "checked"
                ) {
                  document.LED_form.LED1.checked = true;
                } else {
                  document.LED_form.LED1.checked = false;
                }
                // LED 2
                if (
                  this.responseXML.getElementsByTagName("LED")[1].childNodes[0]
                    .nodeValue === "checked"
                ) {
                  document.LED_form.LED2.checked = true;
                } else {
                  document.LED_form.LED2.checked = false;
                }
                // FOCO 1
                if (
                  this.responseXML.getElementsByTagName("LED")[2].childNodes[0]
                    .nodeValue === "on"
                ) {
                 
                  document.getElementById("foco1-1").classList.add('svgon-1')
                  document.getElementById("foco1-1").classList.remove('svg-1');
                  document.getElementById("LED3").innerHTML =
                    "FOCO 1 esta encendido (D8)";
                  LED3_state = 1;
                } else {
                  document.getElementById("foco1-1").classList.add('svg-1')
                  document.getElementById("foco1-1").classList.remove('svgon-1');
                  document.getElementById("LED3").innerHTML =
                    "FOCO 1 esta apagado (D8)";
                  LED3_state = 0;
                }
                // FOCO 2
                if (
                  this.responseXML.getElementsByTagName("LED")[3].childNodes[0]
                    .nodeValue === "on"
                ) {
                  document.getElementById("foco2-1").classList.add('svgon-1')
                  document.getElementById("foco2-1").classList.remove('svg-1');
                  document.getElementById("LED4").innerHTML =
                    "FOCO 4 esta Encendido (D9)";
                  LED4_state = 1;
                } else {
                  document.getElementById("foco2-1").classList.add('svg-1')
                  document.getElementById("foco2-1").classList.remove('svgon-1');
                  document.getElementById("LED4").innerHTML =
                    "FOCO 4 esta Apagado (D9)";
                  LED4_state = 0;
                }
              }
            }
          }
        };
        // send HTTP GET request with LEDs to switch on/off if any
        request.open(
          "GET",
          "ajax_inputs" + strLED1 + strLED2 + strLED3 + strLED4 + nocache,
          true
        );
        request.send(null);
        setTimeout("GetArduinoIO()", 1000);
        strLED1 = "";
        strLED2 = "";
        strLED3 = "";
        strLED4 = "";
      }
      // service LEDs when checkbox checked/unchecked
      function GetCheck() {
        if (LED_form.LED1.checked) {
          strLED1 = "&LED1=1";
        } else {
          strLED1 = "&LED1=0";
        }
        if (LED_form.LED2.checked) {
          strLED2 = "&LED2=1";
        } else {
          strLED2 = "&LED2=0";
        }
      }
      function GetButton1() {
        if (LED3_state === 1) {
          LED3_state = 0;
          strLED3 = "&LED3=0";
        } else {
          LED3_state = 1;
          strLED3 = "&LED3=1";
        }
      }
      function GetButton2() {
        if (LED4_state === 1) {
          LED4_state = 0;
          strLED4 = "&LED4=0";
        } else {
          LED4_state = 1;
          strLED4 = "&LED4=1";
        }
      }
    </script>
  </head>
  <body onload="GetArduinoIO()">
    <header>
      <h1>Mejurdino</h1>
    </header>

    <!--Armario grande-->
    <div class="contArmario">
      <h3>Armario Grande</h3>
      <div class="bordeArmario">
        <!-- <img src="img/svg.svg" alt="" class="imgAG" />  -->

        <div class="ladosArm izq">
          <div class="contfoco1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 64">
              
              <title>Lightbulb</title>
              <g id="Layer_2" data-name="Layer 2">
                <g id="Layer_1-2" data-name="Layer 1">
                  <path id="foco1-1"
                    class="svg-1"
                    d="M44,22a22,22,0,0,1-7.06,16.15A12.25,12.25,0,0,0,33.36,44,11.54,11.54,0,0,0,33,46l-.75,10.24a4,4,0,0,1-4,3.71H15.72a4,4,0,0,1-4-3.71L11,46.19A10.68,10.68,0,0,0,10.61,44,12.56,12.56,0,0,0,7,38.09,22,22,0,1,1,44,22Z"
                  />
                  <path id="foco1-2"
                    class="svg-2"
                    d="M27,46H25V32H19V46H17V32H16a3,3,0,1,1,3-3v1h6V29a3,3,0,1,1,3,3H27Zm0-16h1a1,1,0,1,0-1-1ZM16,28a1,1,0,0,0,0,2h1V29A1,1,0,0,0,16,28Z"
                  />
                  <circle class="cls-3" cx="22" cy="60" r="4" />
                  <path
                    class="cls-4"
                    d="M33.36,44A11.54,11.54,0,0,0,33,46l-.13,1.82L32.58,52l-.3,4.13v.15a4,4,0,0,1-4,3.71H15.72a4.07,4.07,0,0,1-1.67-.36,4,4,0,0,1-2.32-3.35l0-.28-.29-4-.3-4L11,46.19A10.68,10.68,0,0,0,10.61,44Z"
                  />
                  <path
                    class="cls-5"
                    d="M33.36,44A11.54,11.54,0,0,0,33,46l-.13,1.82L11.42,52l-.3-4,20.72-4Z"
                  />
                  <path
                    class="cls-5"
                    d="M32.58,52l-.3,4.13-18.23,3.5a4,4,0,0,1-2.32-3.35l0-.28Z"
                  />
                  <path
                    class="cls-6"
                    d="M32.79,14.73a17,17,0,0,0-7-.15A16.8,16.8,0,0,0,12.22,30v.11a1,1,0,0,1-1.82.54A14.66,14.66,0,0,1,33.75,13.08,1,1,0,0,1,32.79,14.73Z"
                  />
                </g>
              </g>
            </svg>
          </div>
          <h5>T: <span id="T1" class="digital2">...</span></h5>
        </div>

        <div class="ladosArm der">
          <div class="contfoco2">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 64">
              
              <title>Lightbulb</title>
              <g id="Layer_2" data-name="Layer 2">
                <g id="Layer_1-2" data-name="Layer 1">
                  <path id="foco2-1"
                    class="svg-1"
                    d="M44,22a22,22,0,0,1-7.06,16.15A12.25,12.25,0,0,0,33.36,44,11.54,11.54,0,0,0,33,46l-.75,10.24a4,4,0,0,1-4,3.71H15.72a4,4,0,0,1-4-3.71L11,46.19A10.68,10.68,0,0,0,10.61,44,12.56,12.56,0,0,0,7,38.09,22,22,0,1,1,44,22Z"
                  />
                  <path id="foco2-2"
                    class="svg-2"
                    d="M27,46H25V32H19V46H17V32H16a3,3,0,1,1,3-3v1h6V29a3,3,0,1,1,3,3H27Zm0-16h1a1,1,0,1,0-1-1ZM16,28a1,1,0,0,0,0,2h1V29A1,1,0,0,0,16,28Z"
                  />
                  <circle class="cls-3" cx="22" cy="60" r="4" />
                  <path
                    class="cls-4"
                    d="M33.36,44A11.54,11.54,0,0,0,33,46l-.13,1.82L32.58,52l-.3,4.13v.15a4,4,0,0,1-4,3.71H15.72a4.07,4.07,0,0,1-1.67-.36,4,4,0,0,1-2.32-3.35l0-.28-.29-4-.3-4L11,46.19A10.68,10.68,0,0,0,10.61,44Z"
                  />
                  <path
                    class="cls-5"
                    d="M33.36,44A11.54,11.54,0,0,0,33,46l-.13,1.82L11.42,52l-.3-4,20.72-4Z"
                  />
                  <path
                    class="cls-5"
                    d="M32.58,52l-.3,4.13-18.23,3.5a4,4,0,0,1-2.32-3.35l0-.28Z"
                  />
                  <path
                    class="cls-6"
                    d="M32.79,14.73a17,17,0,0,0-7-.15A16.8,16.8,0,0,0,12.22,30v.11a1,1,0,0,1-1.82.54A14.66,14.66,0,0,1,33.75,13.08,1,1,0,0,1,32.79,14.73Z"
                  />
                </g>
              </g>
            </svg>
          </div>
          <h5>T: <span id="T2" class="digital3">...</span></h5>
        </div>
      </div>

      <div class="opcionesAG">
        <button type="button" id="LED3" onclick="GetButton1()">
          FOCO 1 esta Apagado (D8)
        </button>

        <button type="button" id="LED4" onclick="GetButton2()">
          FOCO 4 esta Apagado (D9)
        </button>
      </div>
    </div>

    <div class="sensores">
      <div class="IO_box">
        <h3>Switch Inputs</h3>
        <h5 class="small_text">D0: used by serial RX</h5>
        <h5 class="small_text">D1: used by serial TX</h5>
        <h5>Switch 1 (D2): <span class="switches">...</span></h5>
        <h5>Switch 2 (D3): <span class="switches">...</span></h5>
        <h5 class="small_text">D4: used by Ethernet shield</h5>
        <h5>Switch 3 (D5): <span class="switches">...</span></h5>
      </div>

      <div class="IO_box">
        <h3>LEDs con Checkboxes</h3>
        <form id="check_LEDs" name="LED_form">
          <input
            type="checkbox"
            name="LED1"
            value="0"
            onclick="GetCheck()"
          />LED 1 (D6)<br /><br />
          <input
            type="checkbox"
            name="LED2"
            value="0"
            onclick="GetCheck()"
          />LED 2 (D7)<br /><br />
        </form>
      </div>
    </div>
  </body>
</html>
